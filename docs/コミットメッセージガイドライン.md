# コミットメッセージガイドライン

## 概要

このプロジェクトでは、一貫性のあるコミットメッセージの形式を採用し、プロジェクトの履歴を明確で理解しやすく保ちます。

## コミットメッセージの形式

### 基本形式

```
<type>(<scope>): <subject>

<body>

<footer>
```

### 構成要素の説明

#### 1. Type（必須）

コミットの種類を表します。

| Type       | 説明                                   | 例                                          |
| ---------- | -------------------------------------- | ------------------------------------------- |
| `feat`     | 新機能の追加                           | `feat(chat): 自然言語チャット機能を追加`    |
| `fix`      | バグ修正                               | `fix(api): 認証エラーの修正`                |
| `docs`     | ドキュメントの変更                     | `docs(readme): セットアップ手順を更新`      |
| `style`    | コードスタイルの変更（機能に影響なし） | `style(frontend): ESLintエラーを修正`       |
| `refactor` | リファクタリング                       | `refactor(backend): サービス層を分離`       |
| `test`     | テストの追加・修正                     | `test(api): チャットAPIのテストを追加`      |
| `chore`    | ビルドプロセスや補助ツールの変更       | `chore(deps): 依存関係を更新`               |
| `perf`     | パフォーマンスの改善                   | `perf(backend): データベースクエリを最適化` |
| `ci`       | CI/CD設定の変更                        | `ci(github): 自動テストワークフローを追加`  |
| `build`    | ビルドシステムの変更                   | `build(docker): Dockerfileを最適化`         |

#### 2. Scope（任意）
変更が影響する範囲を指定します。

| Scope      | 説明               |
| ---------- | ------------------ |
| `frontend` | フロントエンド関連 |
| `backend`  | バックエンド関連   |
| `api`      | API関連            |
| `chat`     | チャット機能関連   |
| `auth`     | 認証関連           |
| `aws`      | AWS連携関連        |
| `azure`    | Azure連携関連      |
| `docs`     | ドキュメント関連   |
| `test`     | テスト関連         |
| `config`   | 設定ファイル関連   |

#### 3. Subject（必須）

変更内容を簡潔に説明します。

- 50文字以内で記述
- 動詞の現在形で始める（例：`add`, `fix`, `update`）
- 最初の文字は小文字
- 末尾にピリオドを付けない

#### 4. Body（任意）

変更の詳細を説明します。

- 72文字で改行
- 変更の理由と方法を説明
- 何を変更したか、なぜ変更したかを明確に

#### 5. Footer（任意）

関連するIssueやBreaking Changesを記載します。

- `refs #123` - Issue番号の参照
- `BREAKING CHANGE:` - 破壊的変更の説明

## コミットメッセージの例

### 良い例

```
feat(chat): 自然言語チャット機能を追加

ユーザーが自然言語でクラウドリソースについて質問できる
チャットインターフェースを実装。LLMサービスとMCPサービスを
連携させて、AWSとAzureのリソース情報を取得可能にした。

refs #1
```

```
fix(api): 認証エラーの修正

Azure認証でタイムアウトエラーが発生する問題を修正。
認証トークンの有効期限チェックを追加し、自動更新機能を
実装した。

refs #15
```

```
docs(readme): セットアップ手順を更新

新しい依存関係の追加に伴い、セットアップガイドを更新。
Docker Composeを使用した起動方法を追加した。
```

### 悪い例

```
修正
```

```
update
```

```
feat: 機能追加
```

```
fix: バグ修正しました。いろいろな問題を解決しました。
とても複雑な修正で、多くのファイルを変更しました。
```

## ブランチ命名規則

### 基本形式

```
<type>/<scope>-<description>
```

### 例

- `feature/chat-natural-language`
- `fix/api-authentication-error`
- `docs/setup-guide-update`
- `refactor/backend-service-layer`
- `test/chat-api-coverage`

## プルリクエストのタイトル

プルリクエストのタイトルは、コミットメッセージの形式に従います。

```
feat(chat): 自然言語チャット機能を追加
```

## チェックリスト

コミット前に以下を確認してください：

- [ ] コミットメッセージが形式に従っている
- [ ] 変更内容が明確に説明されている
- [ ] 関連するIssue番号が記載されている（該当する場合）
- [ ] テストが通る
- [ ] コードスタイルが統一されている
- [ ] 不要なファイルが含まれていない

## 自動化

### コミットフック

以下のツールを使用してコミットメッセージの品質を保つことを推奨します：

- `commitlint` - コミットメッセージの形式チェック
- `husky` - Gitフックの管理
- `lint-staged` - ステージされたファイルのリント

### 設定例

```json
// package.json
{
  "husky": {
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  }
}
```

## 例外事項

緊急時のホットフィックスなど、例外的な場合は以下の形式を使用できます：

```
hotfix: 緊急修正 - セキュリティ脆弱性の対応

refs #999
```

## 参考資料

- [Conventional Commits](https://www.conventionalcommits.org/)
- [Angular Commit Message Guidelines](https://github.com/angular/angular/blob/main/CONTRIBUTING.md#commit)
- [Semantic Versioning](https://semver.org/)
